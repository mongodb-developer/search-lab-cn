"use strict";(self.webpackChunksearch_party_lab=self.webpackChunksearch_party_lab||[]).push([[2230],{2366:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>h,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var s=t(5893),n=t(1151);const r={},a="\ud83e\uddb8 Advanced Exercises",i={id:"search-operators/advanced-exercises",title:"\ud83e\uddb8 Advanced Exercises",description:"Extra activity, do it if you have extra time or are following at home, these won't be covered during the hands-on Lab",source:"@site/docs/5-search-operators/10-advanced-exercises.mdx",sourceDirName:"5-search-operators",slug:"/search-operators/advanced-exercises",permalink:"/search-lab-cn/docs/search-operators/advanced-exercises",draft:!1,unlisted:!1,editUrl:"https://github.com/mongodb-developer/search-lab-cn/blob/main/docs/5-search-operators/10-advanced-exercises.mdx",tags:[],version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udc50 Exercises",permalink:"/search-lab-cn/docs/search-operators/exercises"},next:{title:"Faceting",permalink:"/search-lab-cn/docs/category/faceting"}},h={},c=[{value:"Promote shorter books",id:"promote-shorter-books",level:2},{value:"Most available book of the month books",id:"most-available-book-of-the-month-books",level:2},{value:"Most prolific pooh author",id:"most-prolific-pooh-author",level:2},{value:"Assume typos, but still find the matches",id:"assume-typos-but-still-find-the-matches",level:2}];function l(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,n.a)(),...e.components},{Details:t}=o;return t||function(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.h1,{id:"-advanced-exercises",children:"\ud83e\uddb8 Advanced Exercises"}),"\n",(0,s.jsx)(o.admonition,{type:"info",children:(0,s.jsx)(o.p,{children:"Extra activity, do it if you have extra time or are following at home, these won't be covered during the hands-on Lab"})}),"\n",(0,s.jsx)(o.h2,{id:"promote-shorter-books",children:"Promote shorter books"}),"\n",(0,s.jsx)(o.p,{children:"You've noticed that readers tend to prefer shorter books. Without using a large score boost, try to promote shorter books in the search results."}),"\n",(0,s.jsx)(o.admonition,{type:"tip",children:(0,s.jsxs)(o.p,{children:["Even without a score adjuster, the ",(0,s.jsx)(o.a,{href:"https://www.mongodb.com/docs/atlas/atlas-search/compound/#mongodb-data-should",children:(0,s.jsx)(o.code,{children:"should"})})," operator will still boost the score of the documents that match it."]})}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Answer"}),(0,s.jsx)("div",{children:(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-js",children:'public async searchBooks(query: string): Promise<Book[]> {\n    const aggregationPipeline = [\n        {\n          $search: {\n            "index": "fulltextsearch",\n            "compound": {\n              "must": [\n                {\n                  "text": {\n                    query,\n                    "path": ["title", "authors.name", "genres"],\n                    fuzzy: {\n                      maxEdits: 2\n                    }\n                  }\n                }\n              ],\n              "should": [\n                {\n                  "equals": {\n                    "value": true,\n                    "path": "bookOfTheMonth",\n                    "score": {\n                      "boost": { value: 10 }\n                    }\n                  }\n                },\n                {\n                  "range": {\n                    path: "pages",\n                    lt: 80\n                  }\n                }\n              ]\n            }\n          }\n        }\n      ];\n    const books = await collections?.books?.aggregate(aggregationPipeline).toArray() as Book[];\n    return books;\n}\n'})})})]}),"\n",(0,s.jsx)(o.p,{children:"Choose your favourite method to build aggregation pipelines and try to solve the following exercises."}),"\n",(0,s.jsx)(o.h2,{id:"most-available-book-of-the-month-books",children:"Most available book of the month books"}),"\n",(0,s.jsx)(o.p,{children:"Build a search aggregation stage that will promote the books of the month, and will return the books with the most copies available first."}),"\n",(0,s.jsx)(o.h2,{id:"most-prolific-pooh-author",children:"Most prolific pooh author"}),"\n",(0,s.jsx)(o.p,{children:'Find out which author has written the most books that contains the word "pooh" (we\'re talking about the bear here) in the title or in the synopsis.'}),"\n",(0,s.jsx)(o.h2,{id:"assume-typos-but-still-find-the-matches",children:"Assume typos, but still find the matches"}),"\n",(0,s.jsx)(o.p,{children:"Find books that match a user query, but also return books that match with a typo. These books should be returned after the books that match the query."})]})}function d(e={}){const{wrapper:o}={...(0,n.a)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},1151:(e,o,t)=>{t.d(o,{Z:()=>i,a:()=>a});var s=t(7294);const n={},r=s.createContext(n);function a(e){const o=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function i(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(r.Provider,{value:o},e.children)}}}]);